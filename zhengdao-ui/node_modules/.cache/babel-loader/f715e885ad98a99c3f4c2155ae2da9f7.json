{"ast":null,"code":"import \"core-js/modules/es.array.every.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.is-array.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.number.is-nan.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport { watch } from 'vue';\nimport '../../../../constants/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { UPDATE_MODEL_EVENT, INPUT_EVENT } from '../../../../constants/event.mjs';\nimport { throwError, debugWarn } from '../../../../utils/error.mjs';\n\nvar useWatch = function useWatch(props, initData, minValue, maxValue, emit, elFormItem) {\n  var _emit = function _emit(val) {\n    emit(UPDATE_MODEL_EVENT, val);\n    emit(INPUT_EVENT, val);\n  };\n\n  var valueChanged = function valueChanged() {\n    if (props.range) {\n      return ![minValue.value, maxValue.value].every(function (item, index) {\n        return item === initData.oldValue[index];\n      });\n    } else {\n      return props.modelValue !== initData.oldValue;\n    }\n  };\n\n  var setValues = function setValues() {\n    var _a, _b;\n\n    if (props.min > props.max) {\n      throwError(\"Slider\", \"min should not be greater than max.\");\n      return;\n    }\n\n    var val = props.modelValue;\n\n    if (props.range && Array.isArray(val)) {\n      if (val[1] < props.min) {\n        _emit([props.min, props.min]);\n      } else if (val[0] > props.max) {\n        _emit([props.max, props.max]);\n      } else if (val[0] < props.min) {\n        _emit([props.min, val[1]]);\n      } else if (val[1] > props.max) {\n        _emit([val[0], props.max]);\n      } else {\n        initData.firstValue = val[0];\n        initData.secondValue = val[1];\n\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            (_a = elFormItem == null ? void 0 : elFormItem.validate) == null ? void 0 : _a.call(elFormItem, \"change\")[\"catch\"](function (err) {\n              return debugWarn(err);\n            });\n          }\n\n          initData.oldValue = val.slice();\n        }\n      }\n    } else if (!props.range && typeof val === \"number\" && !Number.isNaN(val)) {\n      if (val < props.min) {\n        _emit(props.min);\n      } else if (val > props.max) {\n        _emit(props.max);\n      } else {\n        initData.firstValue = val;\n\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            (_b = elFormItem == null ? void 0 : elFormItem.validate) == null ? void 0 : _b.call(elFormItem, \"change\")[\"catch\"](function (err) {\n              return debugWarn(err);\n            });\n          }\n\n          initData.oldValue = val;\n        }\n      }\n    }\n  };\n\n  setValues();\n  watch(function () {\n    return initData.dragging;\n  }, function (val) {\n    if (!val) {\n      setValues();\n    }\n  });\n  watch(function () {\n    return props.modelValue;\n  }, function (val, oldVal) {\n    if (initData.dragging || Array.isArray(val) && Array.isArray(oldVal) && val.every(function (item, index) {\n      return item === oldVal[index];\n    }) && initData.firstValue === val[0] && initData.secondValue === val[1]) {\n      return;\n    }\n\n    setValues();\n  }, {\n    deep: true\n  });\n  watch(function () {\n    return [props.min, props.max];\n  }, function () {\n    setValues();\n  });\n};\n\nexport { useWatch };","map":{"version":3,"mappings":"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","names":["useWatch","props","initData","minValue","maxValue","emit","elFormItem","_emit","val","UPDATE_MODEL_EVENT","INPUT_EVENT","valueChanged","range","value","every","item","index","oldValue","modelValue","setValues","_a","_b","min","max","throwError","Array","isArray","firstValue","secondValue","validateEvent","validate","call","err","debugWarn","slice","Number","isNaN","watch","dragging","oldVal","deep"],"sources":["../../../../../../../packages/components/slider/src/composables/use-watch.ts"],"sourcesContent":["import { watch } from 'vue'\nimport { INPUT_EVENT, UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport { debugWarn, throwError } from '@element-plus/utils'\nimport type { ComputedRef, SetupContext } from 'vue'\nimport type { Arrayable } from '@element-plus/utils'\nimport type { FormItemContext } from '@element-plus/tokens'\nimport type { SliderEmits, SliderInitData, SliderProps } from '../slider'\n\nexport const useWatch = (\n  props: SliderProps,\n  initData: SliderInitData,\n  minValue: ComputedRef<number>,\n  maxValue: ComputedRef<number>,\n  emit: SetupContext<SliderEmits>['emit'],\n  elFormItem: FormItemContext\n) => {\n  const _emit = (val: Arrayable<number>) => {\n    emit(UPDATE_MODEL_EVENT, val)\n    emit(INPUT_EVENT, val)\n  }\n\n  const valueChanged = () => {\n    if (props.range) {\n      return ![minValue.value, maxValue.value].every(\n        (item, index) => item === (initData.oldValue as number[])[index]\n      )\n    } else {\n      return props.modelValue !== initData.oldValue\n    }\n  }\n\n  const setValues = () => {\n    if (props.min > props.max) {\n      throwError('Slider', 'min should not be greater than max.')\n      return\n    }\n    const val = props.modelValue\n    if (props.range && Array.isArray(val)) {\n      if (val[1] < props.min) {\n        _emit([props.min, props.min])\n      } else if (val[0] > props.max) {\n        _emit([props.max, props.max])\n      } else if (val[0] < props.min) {\n        _emit([props.min, val[1]])\n      } else if (val[1] > props.max) {\n        _emit([val[0], props.max])\n      } else {\n        initData.firstValue = val[0]\n        initData.secondValue = val[1]\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            elFormItem?.validate?.('change').catch((err) => debugWarn(err))\n          }\n          initData.oldValue = val.slice()\n        }\n      }\n    } else if (!props.range && typeof val === 'number' && !Number.isNaN(val)) {\n      if (val < props.min) {\n        _emit(props.min)\n      } else if (val > props.max) {\n        _emit(props.max)\n      } else {\n        initData.firstValue = val\n        if (valueChanged()) {\n          if (props.validateEvent) {\n            elFormItem?.validate?.('change').catch((err) => debugWarn(err))\n          }\n          initData.oldValue = val\n        }\n      }\n    }\n  }\n\n  setValues()\n\n  watch(\n    () => initData.dragging,\n    (val) => {\n      if (!val) {\n        setValues()\n      }\n    }\n  )\n\n  watch(\n    () => props.modelValue,\n    (val, oldVal) => {\n      if (\n        initData.dragging ||\n        (Array.isArray(val) &&\n          Array.isArray(oldVal) &&\n          val.every((item, index) => item === oldVal[index]) &&\n          initData.firstValue === val[0] &&\n          initData.secondValue === val[1])\n      ) {\n        return\n      }\n      setValues()\n    },\n    {\n      deep: true,\n    }\n  )\n\n  watch(\n    () => [props.min, props.max],\n    () => {\n      setValues()\n    }\n  )\n}\n"]},"metadata":{},"sourceType":"module"}