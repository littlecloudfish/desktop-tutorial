{"ast":null,"code":"import _objectSpread from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _createForOfIteratorHelper from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _typeof from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.array.is-array.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.match.js\";\nimport \"core-js/modules/es.regexp.constructor.js\";\nimport \"core-js/modules/es.regexp.dot-all.js\";\nimport \"core-js/modules/es.regexp.sticky.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.number.parse-int.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.number.is-nan.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.reverse.js\";\nimport { createPopper } from '@popperjs/core';\nimport { get } from 'lodash-unified';\nimport escapeHtml from 'escape-html';\nimport '../../../utils/index.mjs';\nimport '../../../hooks/index.mjs';\nimport { hasOwn } from '@vue/shared';\nimport { useZIndex } from '../../../hooks/use-z-index/index.mjs';\n\nvar getCell = function getCell(event) {\n  var _a;\n\n  return (_a = event.target) == null ? void 0 : _a.closest(\"td\");\n};\n\nvar isObject = function isObject(obj) {\n  return obj !== null && _typeof(obj) === \"object\";\n};\n\nvar orderBy = function orderBy(array, sortKey, reverse, sortMethod, sortBy) {\n  if (!sortKey && !sortMethod && (!sortBy || Array.isArray(sortBy) && !sortBy.length)) {\n    return array;\n  }\n\n  if (typeof reverse === \"string\") {\n    reverse = reverse === \"descending\" ? -1 : 1;\n  } else {\n    reverse = reverse && reverse < 0 ? -1 : 1;\n  }\n\n  var getKey = sortMethod ? null : function (value, index) {\n    if (sortBy) {\n      if (!Array.isArray(sortBy)) {\n        sortBy = [sortBy];\n      }\n\n      return sortBy.map(function (by) {\n        if (typeof by === \"string\") {\n          return get(value, by);\n        } else {\n          return by(value, index, array);\n        }\n      });\n    }\n\n    if (sortKey !== \"$key\") {\n      if (isObject(value) && \"$value\" in value) value = value.$value;\n    }\n\n    return [isObject(value) ? get(value, sortKey) : value];\n  };\n\n  var compare = function compare(a, b) {\n    if (sortMethod) {\n      return sortMethod(a.value, b.value);\n    }\n\n    for (var i = 0, len = a.key.length; i < len; i++) {\n      if (a.key[i] < b.key[i]) {\n        return -1;\n      }\n\n      if (a.key[i] > b.key[i]) {\n        return 1;\n      }\n    }\n\n    return 0;\n  };\n\n  return array.map(function (value, index) {\n    return {\n      value: value,\n      index: index,\n      key: getKey ? getKey(value, index) : null\n    };\n  }).sort(function (a, b) {\n    var order = compare(a, b);\n\n    if (!order) {\n      order = a.index - b.index;\n    }\n\n    return order * +reverse;\n  }).map(function (item) {\n    return item.value;\n  });\n};\n\nvar getColumnById = function getColumnById(table, columnId) {\n  var column = null;\n  table.columns.forEach(function (item) {\n    if (item.id === columnId) {\n      column = item;\n    }\n  });\n  return column;\n};\n\nvar getColumnByKey = function getColumnByKey(table, columnKey) {\n  var column = null;\n\n  for (var i = 0; i < table.columns.length; i++) {\n    var item = table.columns[i];\n\n    if (item.columnKey === columnKey) {\n      column = item;\n      break;\n    }\n  }\n\n  return column;\n};\n\nvar getColumnByCell = function getColumnByCell(table, cell, namespace) {\n  var matches = (cell.className || \"\").match(new RegExp(\"\".concat(namespace, \"-table_[^\\\\s]+\"), \"gm\"));\n\n  if (matches) {\n    return getColumnById(table, matches[0]);\n  }\n\n  return null;\n};\n\nvar getRowIdentity = function getRowIdentity(row, rowKey) {\n  if (!row) throw new Error(\"Row is required when get row identity\");\n\n  if (typeof rowKey === \"string\") {\n    if (!rowKey.includes(\".\")) {\n      return \"\".concat(row[rowKey]);\n    }\n\n    var key = rowKey.split(\".\");\n    var current = row;\n\n    var _iterator = _createForOfIteratorHelper(key),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var element = _step.value;\n        current = current[element];\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return \"\".concat(current);\n  } else if (typeof rowKey === \"function\") {\n    return rowKey.call(null, row);\n  }\n};\n\nvar getKeysMap = function getKeysMap(array, rowKey) {\n  var arrayMap = {};\n  (array || []).forEach(function (row, index) {\n    arrayMap[getRowIdentity(row, rowKey)] = {\n      row: row,\n      index: index\n    };\n  });\n  return arrayMap;\n};\n\nfunction mergeOptions(defaults, config) {\n  var options = {};\n  var key;\n\n  for (key in defaults) {\n    options[key] = defaults[key];\n  }\n\n  for (key in config) {\n    if (hasOwn(config, key)) {\n      var value = config[key];\n\n      if (typeof value !== \"undefined\") {\n        options[key] = value;\n      }\n    }\n  }\n\n  return options;\n}\n\nfunction parseWidth(width) {\n  if (width === \"\") return width;\n\n  if (width !== void 0) {\n    width = Number.parseInt(width, 10);\n\n    if (Number.isNaN(width)) {\n      width = \"\";\n    }\n  }\n\n  return width;\n}\n\nfunction parseMinWidth(minWidth) {\n  if (minWidth === \"\") return minWidth;\n\n  if (minWidth !== void 0) {\n    minWidth = parseWidth(minWidth);\n\n    if (Number.isNaN(minWidth)) {\n      minWidth = 80;\n    }\n  }\n\n  return minWidth;\n}\n\nfunction parseHeight(height) {\n  if (typeof height === \"number\") {\n    return height;\n  }\n\n  if (typeof height === \"string\") {\n    if (/^\\d+(?:px)?$/.test(height)) {\n      return Number.parseInt(height, 10);\n    } else {\n      return height;\n    }\n  }\n\n  return null;\n}\n\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\nfunction toggleRowStatus(statusArr, row, newVal) {\n  var changed = false;\n  var index = statusArr.indexOf(row);\n  var included = index !== -1;\n\n  var addRow = function addRow() {\n    statusArr.push(row);\n    changed = true;\n  };\n\n  var removeRow = function removeRow() {\n    statusArr.splice(index, 1);\n    changed = true;\n  };\n\n  if (typeof newVal === \"boolean\") {\n    if (newVal && !included) {\n      addRow();\n    } else if (!newVal && included) {\n      removeRow();\n    }\n  } else {\n    if (included) {\n      removeRow();\n    } else {\n      addRow();\n    }\n  }\n\n  return changed;\n}\n\nfunction walkTreeNode(root, cb) {\n  var childrenKey = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"children\";\n  var lazyKey = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"hasChildren\";\n\n  var isNil = function isNil(array) {\n    return !(Array.isArray(array) && array.length);\n  };\n\n  function _walker(parent, children, level) {\n    cb(parent, children, level);\n    children.forEach(function (item) {\n      if (item[lazyKey]) {\n        cb(item, null, level + 1);\n        return;\n      }\n\n      var children2 = item[childrenKey];\n\n      if (!isNil(children2)) {\n        _walker(item, children2, level + 1);\n      }\n    });\n  }\n\n  root.forEach(function (item) {\n    if (item[lazyKey]) {\n      cb(item, null, 0);\n      return;\n    }\n\n    var children = item[childrenKey];\n\n    if (!isNil(children)) {\n      _walker(item, children, 0);\n    }\n  });\n}\n\nvar _removePopper;\n\nfunction createTablePopper(parentNode, trigger, popperContent, popperOptions, tooltipEffect) {\n  var _useZIndex = useZIndex(),\n      nextZIndex = _useZIndex.nextZIndex;\n\n  var ns = parentNode == null ? void 0 : parentNode.dataset.prefix;\n  var scrollContainer = parentNode == null ? void 0 : parentNode.querySelector(\".\".concat(ns, \"-scrollbar__wrap\"));\n\n  function renderContent() {\n    var isLight = tooltipEffect === \"light\";\n    var content2 = document.createElement(\"div\");\n    content2.className = \"\".concat(ns, \"-popper \").concat(isLight ? \"is-light\" : \"is-dark\");\n    popperContent = escapeHtml(popperContent);\n    content2.innerHTML = popperContent;\n    content2.style.zIndex = String(nextZIndex());\n    parentNode == null ? void 0 : parentNode.appendChild(content2);\n    return content2;\n  }\n\n  function renderArrow() {\n    var arrow2 = document.createElement(\"div\");\n    arrow2.className = \"\".concat(ns, \"-popper__arrow\");\n    return arrow2;\n  }\n\n  function showPopper() {\n    popperInstance && popperInstance.update();\n  }\n\n  _removePopper = function removePopper() {\n    try {\n      popperInstance && popperInstance.destroy();\n      content && (parentNode == null ? void 0 : parentNode.removeChild(content));\n      trigger.removeEventListener(\"mouseenter\", showPopper);\n      trigger.removeEventListener(\"mouseleave\", _removePopper);\n      scrollContainer == null ? void 0 : scrollContainer.removeEventListener(\"scroll\", _removePopper);\n      _removePopper = void 0;\n    } catch (e) {}\n  };\n\n  var popperInstance = null;\n  var content = renderContent();\n  var arrow = renderArrow();\n  content.appendChild(arrow);\n  popperInstance = createPopper(trigger, content, _objectSpread({\n    strategy: \"absolute\",\n    modifiers: [{\n      name: \"offset\",\n      options: {\n        offset: [0, 8]\n      }\n    }, {\n      name: \"arrow\",\n      options: {\n        element: arrow,\n        padding: 10\n      }\n    }]\n  }, popperOptions));\n  trigger.addEventListener(\"mouseenter\", showPopper);\n  trigger.addEventListener(\"mouseleave\", _removePopper);\n  scrollContainer == null ? void 0 : scrollContainer.addEventListener(\"scroll\", _removePopper);\n  return popperInstance;\n}\n\nvar isFixedColumn = function isFixedColumn(index, fixed, store, realColumns) {\n  var start = 0;\n  var after = index;\n\n  if (realColumns) {\n    if (realColumns[index].colSpan > 1) {\n      return {};\n    }\n\n    for (var i = 0; i < index; i++) {\n      start += realColumns[i].colSpan;\n    }\n\n    after = start + realColumns[index].colSpan - 1;\n  } else {\n    start = index;\n  }\n\n  var fixedLayout;\n  var columns = store.states.columns;\n\n  switch (fixed) {\n    case \"left\":\n      if (after < store.states.fixedLeafColumnsLength.value) {\n        fixedLayout = \"left\";\n      }\n\n      break;\n\n    case \"right\":\n      if (start >= columns.value.length - store.states.rightFixedLeafColumnsLength.value) {\n        fixedLayout = \"right\";\n      }\n\n      break;\n\n    default:\n      if (after < store.states.fixedLeafColumnsLength.value) {\n        fixedLayout = \"left\";\n      } else if (start >= columns.value.length - store.states.rightFixedLeafColumnsLength.value) {\n        fixedLayout = \"right\";\n      }\n\n  }\n\n  return fixedLayout ? {\n    direction: fixedLayout,\n    start: start,\n    after: after\n  } : {};\n};\n\nvar getFixedColumnsClass = function getFixedColumnsClass(namespace, index, fixed, store, realColumns) {\n  var classes = [];\n\n  var _isFixedColumn = isFixedColumn(index, fixed, store, realColumns),\n      direction = _isFixedColumn.direction,\n      start = _isFixedColumn.start;\n\n  if (direction) {\n    var isLeft = direction === \"left\";\n    classes.push(\"\".concat(namespace, \"-fixed-column--\").concat(direction));\n\n    if (isLeft && start === store.states.fixedLeafColumnsLength.value - 1) {\n      classes.push(\"is-last-column\");\n    } else if (!isLeft && start === store.states.columns.value.length - store.states.rightFixedLeafColumnsLength.value) {\n      classes.push(\"is-first-column\");\n    }\n  }\n\n  return classes;\n};\n\nfunction getOffset(offset, column) {\n  return offset + (column.realWidth === null || Number.isNaN(column.realWidth) ? Number(column.width) : column.realWidth);\n}\n\nvar getFixedColumnOffset = function getFixedColumnOffset(index, fixed, store, realColumns) {\n  var _isFixedColumn2 = isFixedColumn(index, fixed, store, realColumns),\n      direction = _isFixedColumn2.direction,\n      _isFixedColumn2$start = _isFixedColumn2.start,\n      start = _isFixedColumn2$start === void 0 ? 0 : _isFixedColumn2$start;\n\n  if (!direction) {\n    return;\n  }\n\n  var styles = {};\n  var isLeft = direction === \"left\";\n  var columns = store.states.columns.value;\n\n  if (isLeft) {\n    styles.left = columns.slice(0, index).reduce(getOffset, 0);\n  } else {\n    styles.right = columns.slice(start + 1).reverse().reduce(getOffset, 0);\n  }\n\n  return styles;\n};\n\nvar ensurePosition = function ensurePosition(style, key) {\n  if (!style) return;\n\n  if (!Number.isNaN(style[key])) {\n    style[key] = \"\".concat(style[key], \"px\");\n  }\n};\n\nexport { compose, createTablePopper, ensurePosition, getCell, getColumnByCell, getColumnById, getColumnByKey, getFixedColumnOffset, getFixedColumnsClass, getKeysMap, getRowIdentity, isFixedColumn, mergeOptions, orderBy, parseHeight, parseMinWidth, parseWidth, _removePopper as removePopper, toggleRowStatus, walkTreeNode };","map":{"version":3,"mappings":"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","names":["getCell","event","_a","target","closest","isObject","obj","orderBy","array","sortKey","reverse","sortMethod","sortBy","Array","isArray","length","getKey","value","index","map","by","get","$value","compare","a","b","i","len","key","sort","order","item","getColumnById","table","columnId","column","columns","forEach","id","getColumnByKey","columnKey","getColumnByCell","cell","namespace","matches","className","match","RegExp","getRowIdentity","row","rowKey","Error","includes","split","current","element","call","getKeysMap","arrayMap","mergeOptions","defaults","config","options","hasOwn","parseWidth","width","Number","parseInt","isNaN","parseMinWidth","minWidth","parseHeight","height","test","compose","funcs","arg","reduce","toggleRowStatus","statusArr","newVal","changed","indexOf","included","addRow","push","removeRow","splice","walkTreeNode","root","cb","childrenKey","lazyKey","isNil","_walker","parent","children","level","children2","removePopper","createTablePopper","parentNode","trigger","popperContent","popperOptions","tooltipEffect","useZIndex","nextZIndex","ns","dataset","prefix","scrollContainer","querySelector","renderContent","isLight","content2","document","createElement","escapeHtml","innerHTML","style","zIndex","String","appendChild","renderArrow","arrow2","showPopper","popperInstance","update","destroy","content","removeChild","removeEventListener","e","arrow","createPopper","strategy","modifiers","name","offset","padding","addEventListener","isFixedColumn","fixed","store","realColumns","start","after","colSpan","fixedLayout","states","fixedLeafColumnsLength","rightFixedLeafColumnsLength","direction","getFixedColumnsClass","classes","isLeft","getOffset","realWidth","getFixedColumnOffset","styles","left","slice","right","ensurePosition"],"sources":["../../../../../../packages/components/table/src/util.ts"],"sourcesContent":["// @ts-nocheck\nimport { createPopper } from '@popperjs/core'\nimport { get } from 'lodash-unified'\nimport escapeHtml from 'escape-html'\nimport { hasOwn } from '@element-plus/utils'\nimport { useZIndex } from '@element-plus/hooks'\nimport type {\n  IPopperOptions,\n  PopperInstance,\n} from '@element-plus/components/popper'\nimport type { Nullable } from '@element-plus/utils'\nimport type { TableColumnCtx } from './table-column/defaults'\n\nexport const getCell = function (event: Event) {\n  return (event.target as HTMLElement)?.closest('td')\n}\n\nconst isObject = function (obj: unknown): boolean {\n  return obj !== null && typeof obj === 'object'\n}\n\nexport const orderBy = function <T>(\n  array: T[],\n  sortKey: string,\n  reverse: string | number,\n  sortMethod,\n  sortBy: string | (string | ((a: T, b: T, array?: T[]) => number))[]\n) {\n  if (\n    !sortKey &&\n    !sortMethod &&\n    (!sortBy || (Array.isArray(sortBy) && !sortBy.length))\n  ) {\n    return array\n  }\n  if (typeof reverse === 'string') {\n    reverse = reverse === 'descending' ? -1 : 1\n  } else {\n    reverse = reverse && reverse < 0 ? -1 : 1\n  }\n  const getKey = sortMethod\n    ? null\n    : function (value, index) {\n        if (sortBy) {\n          if (!Array.isArray(sortBy)) {\n            sortBy = [sortBy]\n          }\n          return sortBy.map((by) => {\n            if (typeof by === 'string') {\n              return get(value, by)\n            } else {\n              return by(value, index, array)\n            }\n          })\n        }\n        if (sortKey !== '$key') {\n          if (isObject(value) && '$value' in value) value = value.$value\n        }\n        return [isObject(value) ? get(value, sortKey) : value]\n      }\n  const compare = function (a, b) {\n    if (sortMethod) {\n      return sortMethod(a.value, b.value)\n    }\n    for (let i = 0, len = a.key.length; i < len; i++) {\n      if (a.key[i] < b.key[i]) {\n        return -1\n      }\n      if (a.key[i] > b.key[i]) {\n        return 1\n      }\n    }\n    return 0\n  }\n  return array\n    .map((value, index) => {\n      return {\n        value,\n        index,\n        key: getKey ? getKey(value, index) : null,\n      }\n    })\n    .sort((a, b) => {\n      let order = compare(a, b)\n      if (!order) {\n        // make stable https://en.wikipedia.org/wiki/Sorting_algorithm#Stability\n        order = a.index - b.index\n      }\n      return order * +reverse\n    })\n    .map((item) => item.value)\n}\n\nexport const getColumnById = function <T>(\n  table: {\n    columns: TableColumnCtx<T>[]\n  },\n  columnId: string\n): null | TableColumnCtx<T> {\n  let column = null\n  table.columns.forEach((item) => {\n    if (item.id === columnId) {\n      column = item\n    }\n  })\n  return column\n}\n\nexport const getColumnByKey = function <T>(\n  table: {\n    columns: TableColumnCtx<T>[]\n  },\n  columnKey: string\n): TableColumnCtx<T> {\n  let column = null\n  for (let i = 0; i < table.columns.length; i++) {\n    const item = table.columns[i]\n    if (item.columnKey === columnKey) {\n      column = item\n      break\n    }\n  }\n  return column\n}\n\nexport const getColumnByCell = function <T>(\n  table: {\n    columns: TableColumnCtx<T>[]\n  },\n  cell: HTMLElement,\n  namespace: string\n): null | TableColumnCtx<T> {\n  const matches = (cell.className || '').match(\n    new RegExp(`${namespace}-table_[^\\\\s]+`, 'gm')\n  )\n  if (matches) {\n    return getColumnById(table, matches[0])\n  }\n  return null\n}\n\nexport const getRowIdentity = <T>(\n  row: T,\n  rowKey: string | ((row: T) => any)\n): string => {\n  if (!row) throw new Error('Row is required when get row identity')\n  if (typeof rowKey === 'string') {\n    if (!rowKey.includes('.')) {\n      return `${row[rowKey]}`\n    }\n    const key = rowKey.split('.')\n    let current = row\n    for (const element of key) {\n      current = current[element]\n    }\n    return `${current}`\n  } else if (typeof rowKey === 'function') {\n    return rowKey.call(null, row)\n  }\n}\n\nexport const getKeysMap = function <T>(\n  array: T[],\n  rowKey: string\n): Record<string, { row: T; index: number }> {\n  const arrayMap = {}\n  ;(array || []).forEach((row, index) => {\n    arrayMap[getRowIdentity(row, rowKey)] = { row, index }\n  })\n  return arrayMap\n}\n\nexport function mergeOptions<T, K>(defaults: T, config: K): T & K {\n  const options = {} as T & K\n  let key\n  for (key in defaults) {\n    options[key] = defaults[key]\n  }\n  for (key in config) {\n    if (hasOwn(config as unknown as Record<string, any>, key)) {\n      const value = config[key]\n      if (typeof value !== 'undefined') {\n        options[key] = value\n      }\n    }\n  }\n  return options\n}\n\nexport function parseWidth(width: number | string): number | string {\n  if (width === '') return width\n  if (width !== undefined) {\n    width = Number.parseInt(width as string, 10)\n    if (Number.isNaN(width)) {\n      width = ''\n    }\n  }\n  return width\n}\n\nexport function parseMinWidth(minWidth: number | string): number | string {\n  if (minWidth === '') return minWidth\n  if (minWidth !== undefined) {\n    minWidth = parseWidth(minWidth)\n    if (Number.isNaN(minWidth)) {\n      minWidth = 80\n    }\n  }\n  return minWidth\n}\n\nexport function parseHeight(height: number | string) {\n  if (typeof height === 'number') {\n    return height\n  }\n  if (typeof height === 'string') {\n    if (/^\\d+(?:px)?$/.test(height)) {\n      return Number.parseInt(height, 10)\n    } else {\n      return height\n    }\n  }\n  return null\n}\n\n// https://github.com/reduxjs/redux/blob/master/src/compose.js\nexport function compose(...funcs) {\n  if (funcs.length === 0) {\n    return (arg) => arg\n  }\n  if (funcs.length === 1) {\n    return funcs[0]\n  }\n  return funcs.reduce(\n    (a, b) =>\n      (...args) =>\n        a(b(...args))\n  )\n}\n\nexport function toggleRowStatus<T>(\n  statusArr: T[],\n  row: T,\n  newVal: boolean\n): boolean {\n  let changed = false\n  const index = statusArr.indexOf(row)\n  const included = index !== -1\n\n  const addRow = () => {\n    statusArr.push(row)\n    changed = true\n  }\n  const removeRow = () => {\n    statusArr.splice(index, 1)\n    changed = true\n  }\n\n  if (typeof newVal === 'boolean') {\n    if (newVal && !included) {\n      addRow()\n    } else if (!newVal && included) {\n      removeRow()\n    }\n  } else {\n    if (included) {\n      removeRow()\n    } else {\n      addRow()\n    }\n  }\n  return changed\n}\n\nexport function walkTreeNode(\n  root,\n  cb,\n  childrenKey = 'children',\n  lazyKey = 'hasChildren'\n) {\n  const isNil = (array) => !(Array.isArray(array) && array.length)\n\n  function _walker(parent, children, level) {\n    cb(parent, children, level)\n    children.forEach((item) => {\n      if (item[lazyKey]) {\n        cb(item, null, level + 1)\n        return\n      }\n      const children = item[childrenKey]\n      if (!isNil(children)) {\n        _walker(item, children, level + 1)\n      }\n    })\n  }\n\n  root.forEach((item) => {\n    if (item[lazyKey]) {\n      cb(item, null, 0)\n      return\n    }\n    const children = item[childrenKey]\n    if (!isNil(children)) {\n      _walker(item, children, 0)\n    }\n  })\n}\n\nexport let removePopper\n\nexport function createTablePopper(\n  parentNode: HTMLElement | undefined,\n  trigger: HTMLElement,\n  popperContent: string,\n  popperOptions: Partial<IPopperOptions>,\n  tooltipEffect: string\n) {\n  const { nextZIndex } = useZIndex()\n  const ns = parentNode?.dataset.prefix\n  const scrollContainer = parentNode?.querySelector(`.${ns}-scrollbar__wrap`)\n  function renderContent(): HTMLDivElement {\n    const isLight = tooltipEffect === 'light'\n    const content = document.createElement('div')\n    content.className = `${ns}-popper ${isLight ? 'is-light' : 'is-dark'}`\n    popperContent = escapeHtml(popperContent)\n    content.innerHTML = popperContent\n    content.style.zIndex = String(nextZIndex())\n    // Avoid side effects caused by append to body\n    parentNode?.appendChild(content)\n    return content\n  }\n  function renderArrow(): HTMLDivElement {\n    const arrow = document.createElement('div')\n    arrow.className = `${ns}-popper__arrow`\n    return arrow\n  }\n  function showPopper() {\n    popperInstance && popperInstance.update()\n  }\n  removePopper = () => {\n    try {\n      popperInstance && popperInstance.destroy()\n      content && parentNode?.removeChild(content)\n      trigger.removeEventListener('mouseenter', showPopper)\n      trigger.removeEventListener('mouseleave', removePopper)\n      scrollContainer?.removeEventListener('scroll', removePopper)\n      removePopper = undefined\n    } catch {}\n  }\n  let popperInstance: Nullable<PopperInstance> = null\n  const content = renderContent()\n  const arrow = renderArrow()\n  content.appendChild(arrow)\n  popperInstance = createPopper(trigger, content, {\n    strategy: 'absolute',\n    modifiers: [\n      {\n        name: 'offset',\n        options: {\n          offset: [0, 8],\n        },\n      },\n      {\n        name: 'arrow',\n        options: {\n          element: arrow,\n          padding: 10,\n        },\n      },\n    ],\n    ...popperOptions,\n  })\n  trigger.addEventListener('mouseenter', showPopper)\n  trigger.addEventListener('mouseleave', removePopper)\n  scrollContainer?.addEventListener('scroll', removePopper)\n  return popperInstance\n}\n\nexport const isFixedColumn = <T>(\n  index: number,\n  fixed: string | boolean,\n  store: any,\n  realColumns?: TableColumnCtx<T>[]\n) => {\n  let start = 0\n  let after = index\n  if (realColumns) {\n    if (realColumns[index].colSpan > 1) {\n      // fixed column not supported in grouped header\n      return {}\n    }\n    // handle group\n    for (let i = 0; i < index; i++) {\n      start += realColumns[i].colSpan\n    }\n    after = start + realColumns[index].colSpan - 1\n  } else {\n    start = index\n  }\n  let fixedLayout\n  const columns = store.states.columns\n  switch (fixed) {\n    case 'left':\n      if (after < store.states.fixedLeafColumnsLength.value) {\n        fixedLayout = 'left'\n      }\n      break\n    case 'right':\n      if (\n        start >=\n        columns.value.length - store.states.rightFixedLeafColumnsLength.value\n      ) {\n        fixedLayout = 'right'\n      }\n      break\n    default:\n      if (after < store.states.fixedLeafColumnsLength.value) {\n        fixedLayout = 'left'\n      } else if (\n        start >=\n        columns.value.length - store.states.rightFixedLeafColumnsLength.value\n      ) {\n        fixedLayout = 'right'\n      }\n  }\n  return fixedLayout\n    ? {\n        direction: fixedLayout,\n        start,\n        after,\n      }\n    : {}\n}\n\nexport const getFixedColumnsClass = <T>(\n  namespace: string,\n  index: number,\n  fixed: string | boolean,\n  store: any,\n  realColumns?: TableColumnCtx<T>[]\n) => {\n  const classes: string[] = []\n  const { direction, start } = isFixedColumn(index, fixed, store, realColumns)\n  if (direction) {\n    const isLeft = direction === 'left'\n    classes.push(`${namespace}-fixed-column--${direction}`)\n    if (isLeft && start === store.states.fixedLeafColumnsLength.value - 1) {\n      classes.push('is-last-column')\n    } else if (\n      !isLeft &&\n      start ===\n        store.states.columns.value.length -\n          store.states.rightFixedLeafColumnsLength.value\n    ) {\n      classes.push('is-first-column')\n    }\n  }\n  return classes\n}\n\nfunction getOffset<T>(offset: number, column: TableColumnCtx<T>) {\n  return (\n    offset +\n    (column.realWidth === null || Number.isNaN(column.realWidth)\n      ? Number(column.width)\n      : column.realWidth)\n  )\n}\n\nexport const getFixedColumnOffset = <T>(\n  index: number,\n  fixed: string | boolean,\n  store: any,\n  realColumns?: TableColumnCtx<T>[]\n) => {\n  const { direction, start = 0 } = isFixedColumn(\n    index,\n    fixed,\n    store,\n    realColumns\n  )\n  if (!direction) {\n    return\n  }\n  const styles: any = {}\n  const isLeft = direction === 'left'\n  const columns = store.states.columns.value\n  if (isLeft) {\n    styles.left = columns.slice(0, index).reduce(getOffset, 0)\n  } else {\n    styles.right = columns\n      .slice(start + 1)\n      .reverse()\n      .reduce(getOffset, 0)\n  }\n  return styles\n}\n\nexport const ensurePosition = (style, key: string) => {\n  if (!style) return\n  if (!Number.isNaN(style[key])) {\n    style[key] = `${style[key]}px`\n  }\n}\n"]},"metadata":{},"sourceType":"module"}