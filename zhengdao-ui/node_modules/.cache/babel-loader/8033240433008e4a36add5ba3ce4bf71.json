{"ast":null,"code":"import { ref, unref, watch } from 'vue';\n\nvar useScrollbar = function useScrollbar(props, _ref) {\n  var mainTableRef = _ref.mainTableRef,\n      leftTableRef = _ref.leftTableRef,\n      rightTableRef = _ref.rightTableRef,\n      onMaybeEndReached = _ref.onMaybeEndReached;\n  var scrollPos = ref({\n    scrollLeft: 0,\n    scrollTop: 0\n  });\n\n  function doScroll(params) {\n    var _a, _b, _c;\n\n    var scrollTop = params.scrollTop;\n    (_a = mainTableRef.value) == null ? void 0 : _a.scrollTo(params);\n    (_b = leftTableRef.value) == null ? void 0 : _b.scrollToTop(scrollTop);\n    (_c = rightTableRef.value) == null ? void 0 : _c.scrollToTop(scrollTop);\n  }\n\n  function scrollTo(params) {\n    scrollPos.value = params;\n    doScroll(params);\n  }\n\n  function scrollToTop(scrollTop) {\n    scrollPos.value.scrollTop = scrollTop;\n    doScroll(unref(scrollPos));\n  }\n\n  function scrollToLeft(scrollLeft) {\n    var _a, _b;\n\n    scrollPos.value.scrollLeft = scrollLeft;\n    (_b = (_a = mainTableRef.value) == null ? void 0 : _a.scrollTo) == null ? void 0 : _b.call(_a, unref(scrollPos));\n  }\n\n  function onScroll(params) {\n    var _a;\n\n    scrollTo(params);\n    (_a = props.onScroll) == null ? void 0 : _a.call(props, params);\n  }\n\n  function onVerticalScroll(_ref2) {\n    var scrollTop = _ref2.scrollTop;\n\n    var _unref = unref(scrollPos),\n        currentScrollTop = _unref.scrollTop;\n\n    if (scrollTop !== currentScrollTop) scrollToTop(scrollTop);\n  }\n\n  function scrollToRow(row) {\n    var strategy = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"auto\";\n\n    var _a;\n\n    (_a = mainTableRef.value) == null ? void 0 : _a.scrollToRow(row, strategy);\n  }\n\n  watch(function () {\n    return unref(scrollPos).scrollTop;\n  }, function (cur, prev) {\n    if (cur > prev) onMaybeEndReached();\n  });\n  return {\n    scrollPos: scrollPos,\n    scrollTo: scrollTo,\n    scrollToLeft: scrollToLeft,\n    scrollToTop: scrollToTop,\n    scrollToRow: scrollToRow,\n    onScroll: onScroll,\n    onVerticalScroll: onVerticalScroll\n  };\n};\n\nexport { useScrollbar };","map":{"version":3,"mappings":"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","names":["useScrollbar","props","mainTableRef","leftTableRef","rightTableRef","onMaybeEndReached","scrollPos","ref","scrollLeft","scrollTop","doScroll","params","_a","_b","_c","value","scrollTo","scrollToTop","unref","scrollToLeft","call","onScroll","onVerticalScroll","currentScrollTop","scrollToRow","row","strategy","watch","cur","prev"],"sources":["../../../../../../../packages/components/table-v2/src/composables/use-scrollbar.ts"],"sourcesContent":["import { ref, unref, watch } from 'vue'\n\nimport type { Ref } from 'vue'\nimport type { Alignment as ScrollStrategy } from '@element-plus/components/virtual-list'\nimport type { TableV2Props } from '../table'\nimport type { TableGridInstance } from '../table-grid'\n\nexport type ScrollPos = { scrollLeft: number; scrollTop: number }\ntype GridInstanceRef = Ref<TableGridInstance | undefined>\n\ntype UseScrollBarProps = {\n  mainTableRef: GridInstanceRef\n  leftTableRef: GridInstanceRef\n  rightTableRef: GridInstanceRef\n\n  onMaybeEndReached: () => void\n}\n\nexport type { ScrollStrategy }\n\nexport const useScrollbar = (\n  props: TableV2Props,\n  {\n    mainTableRef,\n    leftTableRef,\n    rightTableRef,\n    onMaybeEndReached,\n  }: UseScrollBarProps\n) => {\n  const scrollPos = ref<ScrollPos>({ scrollLeft: 0, scrollTop: 0 })\n\n  function doScroll(params: ScrollPos) {\n    const { scrollTop } = params\n\n    mainTableRef.value?.scrollTo(params)\n    leftTableRef.value?.scrollToTop(scrollTop)\n    rightTableRef.value?.scrollToTop(scrollTop)\n  }\n\n  // methods\n  function scrollTo(params: ScrollPos) {\n    scrollPos.value = params\n\n    doScroll(params)\n  }\n\n  function scrollToTop(scrollTop: number) {\n    scrollPos.value.scrollTop = scrollTop\n\n    doScroll(unref(scrollPos))\n  }\n\n  function scrollToLeft(scrollLeft: number) {\n    scrollPos.value.scrollLeft = scrollLeft\n\n    mainTableRef.value?.scrollTo?.(unref(scrollPos))\n  }\n\n  function onScroll(params: ScrollPos) {\n    scrollTo(params)\n    props.onScroll?.(params)\n  }\n\n  function onVerticalScroll({ scrollTop }: ScrollPos) {\n    const { scrollTop: currentScrollTop } = unref(scrollPos)\n    if (scrollTop !== currentScrollTop) scrollToTop(scrollTop)\n  }\n\n  function scrollToRow(row: number, strategy: ScrollStrategy = 'auto') {\n    mainTableRef.value?.scrollToRow(row, strategy)\n  }\n\n  // When scrollTop changes, maybe reaching the bottom\n  watch(\n    () => unref(scrollPos).scrollTop,\n    (cur, prev) => {\n      if (cur > prev) onMaybeEndReached()\n    }\n  )\n\n  return {\n    scrollPos,\n\n    scrollTo,\n    scrollToLeft,\n    scrollToTop,\n    scrollToRow,\n    onScroll,\n    onVerticalScroll,\n  }\n}\n"]},"metadata":{},"sourceType":"module"}