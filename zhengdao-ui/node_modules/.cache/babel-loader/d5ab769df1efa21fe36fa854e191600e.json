{"ast":null,"code":"import _slicedToArray from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _defineProperty from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _toConsumableArray from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport { warn } from 'vue';\nimport { fromPairs } from 'lodash-unified';\nimport '../../types.mjs';\nimport '../../objects.mjs';\nimport { isObject, hasOwn } from '@vue/shared';\nvar epPropKey = \"__epPropKey\";\n\nvar definePropType = function definePropType(val) {\n  return val;\n};\n\nvar isEpProp = function isEpProp(val) {\n  return isObject(val) && !!val[epPropKey];\n};\n\nvar buildProp = function buildProp(prop, key) {\n  if (!isObject(prop) || isEpProp(prop)) return prop;\n  var values = prop.values,\n      required = prop.required,\n      defaultValue = prop[\"default\"],\n      type = prop.type,\n      validator = prop.validator;\n\n  var _validator = values || validator ? function (val) {\n    var valid = false;\n    var allowedValues = [];\n\n    if (values) {\n      allowedValues = Array.from(values);\n\n      if (hasOwn(prop, \"default\")) {\n        allowedValues.push(defaultValue);\n      }\n\n      valid || (valid = allowedValues.includes(val));\n    }\n\n    if (validator) valid || (valid = validator(val));\n\n    if (!valid && allowedValues.length > 0) {\n      var allowValuesText = _toConsumableArray(new Set(allowedValues)).map(function (value) {\n        return JSON.stringify(value);\n      }).join(\", \");\n\n      warn(\"Invalid prop: validation failed\".concat(key ? \" for prop \\\"\".concat(key, \"\\\"\") : \"\", \". Expected one of [\").concat(allowValuesText, \"], got value \").concat(JSON.stringify(val), \".\"));\n    }\n\n    return valid;\n  } : void 0;\n\n  var epProp = _defineProperty({\n    type: type,\n    required: !!required,\n    validator: _validator\n  }, epPropKey, true);\n\n  if (hasOwn(prop, \"default\")) epProp[\"default\"] = defaultValue;\n  return epProp;\n};\n\nvar buildProps = function buildProps(props) {\n  return fromPairs(Object.entries(props).map(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        option = _ref2[1];\n\n    return [key, buildProp(option, key)];\n  }));\n};\n\nexport { buildProp, buildProps, definePropType, epPropKey, isEpProp };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;AAIY,IAACA,SAAS,GAAG,aAAb;;AACA,IAACC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,GAAD;EAAA,OAASA,GAAT;AAAA,CAAlB;;AACA,IAACC,QAAQ,GAAG,SAAXA,QAAW,CAACD,GAAD;EAAA,OAASE,QAAQ,CAACF,GAAD,CAAR,IAAiB,CAAC,CAACA,GAAG,CAACF,SAAD,CAA/B;AAAA,CAAZ;;AACA,IAACK,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD,EAAOC,GAAP,EAAe;EACtC,IAAI,CAACH,QAAQ,CAACE,IAAD,CAAT,IAAmBH,QAAQ,CAACG,IAAD,CAA/B,EACE,OAAOA,IAAP;EACF,IAAQE,MAAR,GAAqEF,IAArE,CAAQE,MAAR;EAAA,IAAgBC,QAAhB,GAAqEH,IAArE,CAAgBG,QAAhB;EAAA,IAAmCC,YAAnC,GAAqEJ,IAArE;EAAA,IAAiDK,IAAjD,GAAqEL,IAArE,CAAiDK,IAAjD;EAAA,IAAuDC,SAAvD,GAAqEN,IAArE,CAAuDM,SAAvD;;EACA,IAAMC,UAAU,GAAGL,MAAM,IAAII,SAAV,GAAsB,UAACV,GAAD,EAAS;IAChD,IAAIY,KAAK,GAAG,KAAZ;IACA,IAAIC,aAAa,GAAG,EAApB;;IACA,IAAIP,MAAJ,EAAY;MACVO,aAAa,GAAGC,KAAK,CAACC,IAAN,CAAWT,MAAX,CAAhB;;MACA,IAAIU,MAAM,CAACZ,IAAD,EAAO,SAAP,CAAV,EAA6B;QAC3BS,aAAa,CAACI,IAAd,CAAmBT,YAAnB;MACD;;MACDI,KAAK,KAAKA,KAAK,GAAGC,aAAa,CAACK,QAAd,CAAuBlB,GAAvB,CAAb,CAAL;IACD;;IACD,IAAIU,SAAJ,EACEE,KAAK,KAAKA,KAAK,GAAGF,SAAS,CAACV,GAAD,CAAtB,CAAL;;IACF,IAAI,CAACY,KAAD,IAAUC,aAAa,CAACM,MAAd,GAAuB,CAArC,EAAwC;MACtC,IAAMC,eAAe,GAAG,mBAAI,IAAIC,GAAJ,CAAQR,aAAR,CAAJ,EAA4BS,GAA5B,CAAgC,UAACC,KAAD;QAAA,OAAWC,IAAI,CAACC,SAAL,CAAeF,KAAf,CAAX;MAAA,CAAhC,EAAkEG,IAAlE,CAAuE,IAAvE,CAAxB;;MACAC,IAAI,0CAAmCtB,GAAG,yBAAiBA,GAAjB,UAA0B,EAAhE,gCAAwFe,eAAxF,0BAAuHI,IAAI,CAACC,SAAL,CAAezB,GAAf,CAAvH,OAAJ;IACD;;IACD,OAAOY,KAAP;EACD,CAjBkB,GAiBf,KAAK,CAjBT;;EAkBA,IAAMgB,MAAM;IACVnB,IAAI,EAAJA,IADU;IAEVF,QAAQ,EAAE,CAAC,CAACA,QAFF;IAGVG,SAAS,EAAEC;EAHD,GAITb,SAJS,EAIG,IAJH,CAAZ;;EAMA,IAAIkB,MAAM,CAACZ,IAAD,EAAO,SAAP,CAAV,EACEwB,MAAM,WAAN,GAAiBpB,YAAjB;EACF,OAAOoB,MAAP;AACF,CA/BY;;AAgCA,IAACC,UAAU,GAAG,SAAbA,UAAa,CAACC,KAAD;EAAA,OAAWC,SAAS,CAACC,MAAM,CAACC,OAAP,CAAeH,KAAf,EAAsBR,GAAtB,CAA0B;IAAA;IAAA,IAAEjB,GAAF;IAAA,IAAO6B,MAAP;;IAAA,OAAmB,CAC1F7B,GAD0F,EAE1FF,SAAS,CAAC+B,MAAD,EAAS7B,GAAT,CAFiF,CAAnB;EAAA,CAA1B,CAAD,CAApB;AAAA,CAAd","names":["epPropKey","definePropType","val","isEpProp","isObject","buildProp","prop","key","values","required","defaultValue","type","validator","_validator","valid","allowedValues","Array","from","hasOwn","push","includes","length","allowValuesText","Set","map","value","JSON","stringify","join","warn","epProp","buildProps","props","fromPairs","Object","entries","option"],"sources":["../../../../../../packages/utils/vue/props/runtime.ts"],"sourcesContent":["import { warn } from 'vue'\nimport { fromPairs } from 'lodash-unified'\nimport { isObject } from '../../types'\nimport { hasOwn } from '../../objects'\n\nimport type { PropType } from 'vue'\nimport type {\n  EpProp,\n  EpPropConvert,\n  EpPropFinalized,\n  EpPropInput,\n  EpPropMergeType,\n  IfEpProp,\n  IfNativePropType,\n  NativePropType,\n} from './types'\n\nexport const epPropKey = '__epPropKey'\n\nexport const definePropType = <T>(val: any): PropType<T> => val\n\nexport const isEpProp = (val: unknown): val is EpProp<any, any, any> =>\n  isObject(val) && !!(val as any)[epPropKey]\n\n/**\n * @description Build prop. It can better optimize prop types\n * @description 生成 prop，能更好地优化类型\n * @example\n  // limited options\n  // the type will be PropType<'light' | 'dark'>\n  buildProp({\n    type: String,\n    values: ['light', 'dark'],\n  } as const)\n  * @example\n  // limited options and other types\n  // the type will be PropType<'small' | 'large' | number>\n  buildProp({\n    type: [String, Number],\n    values: ['small', 'large'],\n    validator: (val: unknown): val is number => typeof val === 'number',\n  } as const)\n  @link see more: https://github.com/element-plus/element-plus/pull/3341\n */\nexport const buildProp = <\n  Type = never,\n  Value = never,\n  Validator = never,\n  Default extends EpPropMergeType<Type, Value, Validator> = never,\n  Required extends boolean = false\n>(\n  prop: EpPropInput<Type, Value, Validator, Default, Required>,\n  key?: string\n): EpPropFinalized<Type, Value, Validator, Default, Required> => {\n  // filter native prop type and nested prop, e.g `null`, `undefined` (from `buildProps`)\n  if (!isObject(prop) || isEpProp(prop)) return prop as any\n\n  const { values, required, default: defaultValue, type, validator } = prop\n\n  const _validator =\n    values || validator\n      ? (val: unknown) => {\n          let valid = false\n          let allowedValues: unknown[] = []\n\n          if (values) {\n            allowedValues = Array.from(values)\n            if (hasOwn(prop, 'default')) {\n              allowedValues.push(defaultValue)\n            }\n            valid ||= allowedValues.includes(val)\n          }\n          if (validator) valid ||= validator(val)\n\n          if (!valid && allowedValues.length > 0) {\n            const allowValuesText = [...new Set(allowedValues)]\n              .map((value) => JSON.stringify(value))\n              .join(', ')\n            warn(\n              `Invalid prop: validation failed${\n                key ? ` for prop \"${key}\"` : ''\n              }. Expected one of [${allowValuesText}], got value ${JSON.stringify(\n                val\n              )}.`\n            )\n          }\n          return valid\n        }\n      : undefined\n\n  const epProp: any = {\n    type,\n    required: !!required,\n    validator: _validator,\n    [epPropKey]: true,\n  }\n  if (hasOwn(prop, 'default')) epProp.default = defaultValue\n  return epProp\n}\n\nexport const buildProps = <\n  Props extends Record<\n    string,\n    | { [epPropKey]: true }\n    | NativePropType\n    | EpPropInput<any, any, any, any, any>\n  >\n>(\n  props: Props\n): {\n  [K in keyof Props]: IfEpProp<\n    Props[K],\n    Props[K],\n    IfNativePropType<Props[K], Props[K], EpPropConvert<Props[K]>>\n  >\n} =>\n  fromPairs(\n    Object.entries(props).map(([key, option]) => [\n      key,\n      buildProp(option as any, key),\n    ])\n  ) as any\n"]},"metadata":{},"sourceType":"module"}