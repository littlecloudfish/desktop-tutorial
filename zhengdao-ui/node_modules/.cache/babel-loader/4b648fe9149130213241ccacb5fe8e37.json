{"ast":null,"code":"import _classCallCheck from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/little/Documents/music_web/startproj/zhengdao-ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport '../../../../utils/index.mjs';\nimport '../../../../constants/index.mjs';\nimport { EVENT_CODE } from '../../../../constants/aria.mjs';\nimport { triggerEvent } from '../../../../utils/dom/aria.mjs';\n\nvar SubMenu = /*#__PURE__*/function () {\n  function SubMenu(parent, domNode) {\n    _classCallCheck(this, SubMenu);\n\n    this.parent = parent;\n    this.domNode = domNode;\n    this.subIndex = 0;\n    this.subIndex = 0;\n    this.init();\n  }\n\n  _createClass(SubMenu, [{\n    key: \"init\",\n    value: function init() {\n      this.subMenuItems = this.domNode.querySelectorAll(\"li\");\n      this.addListeners();\n    }\n  }, {\n    key: \"gotoSubIndex\",\n    value: function gotoSubIndex(idx) {\n      if (idx === this.subMenuItems.length) {\n        idx = 0;\n      } else if (idx < 0) {\n        idx = this.subMenuItems.length - 1;\n      }\n\n      ;\n      this.subMenuItems[idx].focus();\n      this.subIndex = idx;\n    }\n  }, {\n    key: \"addListeners\",\n    value: function addListeners() {\n      var _this = this;\n\n      var parentNode = this.parent.domNode;\n      Array.prototype.forEach.call(this.subMenuItems, function (el) {\n        el.addEventListener(\"keydown\", function (event) {\n          var prevDef = false;\n\n          switch (event.code) {\n            case EVENT_CODE.down:\n              {\n                _this.gotoSubIndex(_this.subIndex + 1);\n\n                prevDef = true;\n                break;\n              }\n\n            case EVENT_CODE.up:\n              {\n                _this.gotoSubIndex(_this.subIndex - 1);\n\n                prevDef = true;\n                break;\n              }\n\n            case EVENT_CODE.tab:\n              {\n                triggerEvent(parentNode, \"mouseleave\");\n                break;\n              }\n\n            case EVENT_CODE.enter:\n            case EVENT_CODE.space:\n              {\n                prevDef = true;\n                event.currentTarget.click();\n                break;\n              }\n          }\n\n          if (prevDef) {\n            event.preventDefault();\n            event.stopPropagation();\n          }\n\n          return false;\n        });\n      });\n    }\n  }]);\n\n  return SubMenu;\n}();\n\nexport { SubMenu as default };","map":{"version":3,"mappings":";;;;;;;;;IAEMA,O;EACJ,iBAAYC,MAAZ,EAAoBC,OAApB,EAA6B;IAAA;;IAC3B,KAAKD,MAAL,GAAcA,MAAd;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,KAAKC,QAAL,GAAgB,CAAhB;IACA,KAAKA,QAAL,GAAgB,CAAhB;IACA,KAAKC,IAAL;EACD;;;;WACD,gBAAO;MACL,KAAKC,YAAL,GAAoB,KAAKH,OAAL,CAAaI,gBAAb,CAA8B,IAA9B,CAApB;MACA,KAAKC,YAAL;IACD;;;WACD,sBAAaC,GAAb,EAAkB;MAChB,IAAIA,GAAG,KAAK,KAAKH,YAAL,CAAkBI,MAA9B,EAAsC;QACpCD,GAAG,GAAG,CAAN;MACD,CAFD,MAEO,IAAIA,GAAG,GAAG,CAAV,EAAa;QAClBA,GAAG,GAAG,KAAKH,YAAL,CAAkBI,MAAlB,GAA2B,CAAjC;MACD;;MACD;MACA,KAAKJ,YAAL,CAAkBG,GAAlB,EAAuBE,KAAvB;MACA,KAAKP,QAAL,GAAgBK,GAAhB;IACD;;;WACD,wBAAe;MAAA;;MACb,IAAMG,UAAU,GAAG,KAAKV,MAAL,CAAYC,OAA/B;MACAU,KAAK,CAACC,SAAN,CAAgBC,OAAhB,CAAwBC,IAAxB,CAA6B,KAAKV,YAAlC,EAAgD,UAACW,EAAD,EAAQ;QACtDA,EAAE,CAACC,gBAAH,CAAoB,SAApB,EAA+B,UAACC,KAAD,EAAW;UACxC,IAAIC,OAAO,GAAG,KAAd;;UACA,QAAQD,KAAK,CAACE,IAAd;YACE,KAAKC,UAAU,CAACC,IAAhB;cAAsB;gBACpB,KAAI,CAACC,YAAL,CAAkB,KAAI,CAACpB,QAAL,GAAgB,CAAlC;;gBACAgB,OAAO,GAAG,IAAV;gBACA;cACD;;YACD,KAAKE,UAAU,CAACG,EAAhB;cAAoB;gBAClB,KAAI,CAACD,YAAL,CAAkB,KAAI,CAACpB,QAAL,GAAgB,CAAlC;;gBACAgB,OAAO,GAAG,IAAV;gBACA;cACD;;YACD,KAAKE,UAAU,CAACI,GAAhB;cAAqB;gBACnBC,YAAY,CAACf,UAAD,EAAa,YAAb,CAAZ;gBACA;cACD;;YACD,KAAKU,UAAU,CAACM,KAAhB;YACA,KAAKN,UAAU,CAACO,KAAhB;cAAuB;gBACrBT,OAAO,GAAG,IAAV;gBACAD,KAAK,CAACW,aAAN,CAAoBC,KAApB;gBACA;cACD;UApBH;;UAsBA,IAAIX,OAAJ,EAAa;YACXD,KAAK,CAACa,cAAN;YACAb,KAAK,CAACc,eAAN;UACD;;UACD,OAAO,KAAP;QACD,CA7BD;MA8BD,CA/BD;IAgCD","names":["SubMenu","parent","domNode","subIndex","init","subMenuItems","querySelectorAll","addListeners","idx","length","focus","parentNode","Array","prototype","forEach","call","el","addEventListener","event","prevDef","code","EVENT_CODE","down","gotoSubIndex","up","tab","triggerEvent","enter","space","currentTarget","click","preventDefault","stopPropagation"],"sources":["../../../../../../../packages/components/menu/src/utils/submenu.ts"],"sourcesContent":["// @ts-nocheck\nimport { triggerEvent } from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport type MenuItem from './menu-item'\n\nclass SubMenu {\n  public subMenuItems: NodeList\n  public subIndex = 0\n  constructor(public parent: MenuItem, public domNode: ParentNode) {\n    this.subIndex = 0\n    this.init()\n  }\n\n  init(): void {\n    this.subMenuItems = this.domNode.querySelectorAll('li')\n    this.addListeners()\n  }\n\n  gotoSubIndex(idx: number): void {\n    if (idx === this.subMenuItems.length) {\n      idx = 0\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1\n    }\n    ;(this.subMenuItems[idx] as HTMLElement).focus()\n    this.subIndex = idx\n  }\n\n  addListeners(): void {\n    const parentNode = this.parent.domNode\n    Array.prototype.forEach.call(this.subMenuItems, (el: Element) => {\n      el.addEventListener('keydown', (event: KeyboardEvent) => {\n        let prevDef = false\n        switch (event.code) {\n          case EVENT_CODE.down: {\n            this.gotoSubIndex(this.subIndex + 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.up: {\n            this.gotoSubIndex(this.subIndex - 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.tab: {\n            triggerEvent(parentNode as HTMLElement, 'mouseleave')\n            break\n          }\n          case EVENT_CODE.enter:\n          case EVENT_CODE.space: {\n            prevDef = true\n            ;(event.currentTarget as HTMLElement).click()\n            break\n          }\n        }\n        if (prevDef) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        return false\n      })\n    })\n  }\n}\n\nexport default SubMenu\n"]},"metadata":{},"sourceType":"module"}